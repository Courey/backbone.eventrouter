{"version":3,"sources":["backbone.eventrouter.js"],"names":[],"mappings":"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","file":"backbone.eventrouter.js","sourcesContent":["/**\n * backbone.eventrouter - A highly opinionated, simplistic Backbone.Router coupled with a Backbone.Radio.Channel\n * @version v0.1.0\n * @link https://github.com/RoundingWellOS/backbone.eventrouter\n * @license MIT\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('underscore'), require('backbone'), require('backbone.radio')) :\n  typeof define === 'function' && define.amd ? define(['underscore', 'backbone', 'backbone.radio'], factory) :\n  global.Backbone.EventRouter = factory(global._, global.Backbone, global.Radio)\n}(this, function (_, Backbone, Radio) { 'use strict';\n\n  var namedParam = /(\\(\\?)?:\\w+/;\n  var slice = [].slice;\n\n  var EventRouter = Backbone.EventRouter = Backbone.Router.extend({\n    constructor: function(options) {\n      options = _.extend({}, options);\n\n      Backbone.Router.apply(this, arguments);\n\n      _.extend(this, _.pick(options, ['channelName', 'routeTriggers']));\n\n      this._ch = Backbone.Radio.channel(_.result(this, 'channelName'));\n\n      if(_.isFunction(this.routeTriggers)) {\n        this.routeTriggers = this.routeTriggers.call(this, options);\n      }\n\n      this._createRoutes();\n\n      this.listenTo(this._ch, 'all', this.handleRoute);\n    },\n\n    channelName: 'event-router',\n\n    getChannel: function() {\n      return this._ch;\n    },\n\n    _createRoutes: function() {\n      _.each(this.routeTriggers, function(routes, event) {\n        routes = _.isArray(routes) ? routes : [routes];\n        _.each(routes, function(route) {\n          this.route(route, event, _.bind(this._ch.trigger, this._ch, event));\n        }, this);\n      }, this);\n    },\n\n    route: function(route, name, callback) {\n      if (_.isFunction(name)) {\n        callback = name;\n        name = '';\n      }\n      if (!callback) {\n        callback = this[name];\n      }\n      if(!callback) {\n        return this;\n      }\n\n      var wrappedCallback = _.bind(function() {\n        var args = slice.call(arguments);\n        this.trigger('before:route', name, args);\n        this.trigger.apply(this, ['before:route:' + name].concat(args));\n        callback.apply(this, args);\n      }, this);\n\n      return Backbone.Router.prototype.route.call(this, route, name, wrappedCallback);\n    },\n\n    handleRoute: function(event) {\n      var route = this.getDefaultRoute(event);\n\n      if(!route) {\n        return this;\n      }\n\n      // remove the event name and the query string from the passed arguments\n      var eventArgs = slice.call(arguments, 1, arguments.length - 1);\n\n      var translatedRoute = this.translateRoute.apply(this, [event, route].concat(eventArgs));\n\n      this.navigate(translatedRoute, { trigger: false });\n\n      return this;\n    },\n\n    getDefaultRoute: function(event) {\n      var routes = this.routeTriggers[event];\n\n      return _.isArray(routes) ? routes[0] : routes;\n    },\n\n    translateRoute: function(routeEvent, route) {\n      var eventArgs = _.tail(arguments, 2);\n\n      var translatedRoute = route;\n\n      _.each(eventArgs, function(arg) {\n        translatedRoute = translatedRoute.replace(namedParam, arg);\n      });\n\n      return translatedRoute;\n    }\n  });\n\n  var backbone_eventrouter = EventRouter;\n\n  return backbone_eventrouter;\n\n}));\n"],"sourceRoot":"/source/"}