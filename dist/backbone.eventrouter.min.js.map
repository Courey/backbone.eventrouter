/**
 * backbone.eventrouter - A highly opinionated, simplistic Backbone.Router coupled with a Backbone.Radio.Channel
 * @version v0.1.0
 * @link https://github.com/RoundingWellOS/backbone.eventrouter
 * @license MIT
 */
{"version":3,"sources":["/source/backbone.eventrouter.js"],"names":["global","factory","exports","module","require","define","amd","Backbone","EventRouter","_","Radio","this","namedParam","slice","Router","extend","constructor","options","apply","arguments","pick","_ch","channel","result","isFunction","routeTriggers","call","_createRoutes","listenTo","handleRoute","channelName","getChannel","each","routes","event","isArray","route","bind","trigger","_route","name","callback","wrappedCallback","args","concat","prototype","getDefaultRoute","eventArgs","length","translatedRoute","translateRoute","navigate","routeEvent","tail","arg","replace","backbone_eventrouter"],"mappings":"CAMC,SAAUA,EAAQC,GACE,gBAAZC,UAA0C,mBAAXC,QAAyBA,OAAOD,QAAUD,EAAQG,QAAQ,cAAeA,QAAQ,YAAaA,QAAQ,mBAC1H,kBAAXC,SAAyBA,OAAOC,IAAMD,QAAQ,aAAc,WAAY,kBAAmBJ,GAClGD,EAAOO,SAASC,YAAcP,EAAQD,EAAOS,EAAGT,EAAOO,SAAUP,EAAOU,QACxEC,KAAM,SAAUF,EAAGF,EAAUG,GAAS,YAEtC,IAAIE,GAAa,cACbC,KAAWA,MAEXL,EAAcD,EAASC,YAAcD,EAASO,OAAOC,QACvDC,YAAa,SAASC,GACpBA,EAAUR,EAAEM,UAAWE,GAEvBV,EAASO,OAAOI,MAAMP,KAAMQ,WAE5BV,EAAEM,OAAOJ,KAAMF,EAAEW,KAAKH,GAAU,cAAe,mBAE/CN,KAAKU,IAAMd,EAASG,MAAMY,QAAQb,EAAEc,OAAOZ,KAAM,gBAE9CF,EAAEe,WAAWb,KAAKc,iBACnBd,KAAKc,cAAgBd,KAAKc,cAAcC,KAAKf,KAAMM,IAGrDN,KAAKgB,gBAELhB,KAAKiB,SAASjB,KAAKU,IAAK,MAAOV,KAAKkB,cAGtCC,YAAa,eAEbC,WAAY,WACV,MAAOpB,MAAKU,KAGdM,cAAe,WACblB,EAAEuB,KAAKrB,KAAKc,cAAe,SAASQ,EAAQC,GAC1CD,EAASxB,EAAE0B,QAAQF,GAAUA,GAAUA,GACvCxB,EAAEuB,KAAKC,EAAQ,SAASG,GACtBzB,KAAKyB,MAAMA,EAAOF,EAAOzB,EAAE4B,KAAK1B,KAAKU,IAAIiB,QAAS3B,KAAKU,IAAKa,KAC3DvB,OACFA,OAGLyB,MAAO,SAASG,EAAOC,EAAMC,GAQ3B,GAPIhC,EAAEe,WAAWgB,KACfC,EAAWD,EACXA,EAAO,IAEJC,IACHA,EAAW9B,KAAK6B,KAEdC,EACF,MAAO9B,KAGT,IAAI+B,GAAkBjC,EAAE4B,KAAK,WAC3B,GAAIM,GAAO9B,EAAMa,KAAKP,UACtBR,MAAK2B,QAAQ,eAAgBE,EAAMG,GACnChC,KAAK2B,QAAQpB,MAAMP,MAAO,gBAAkB6B,GAAMI,OAAOD,IACzDF,EAASvB,MAAMP,KAAMgC,IACpBhC,KAEH,OAAOJ,GAASO,OAAO+B,UAAUT,MAAMV,KAAKf,KAAM4B,EAAOC,EAAME,IAGjEb,YAAa,SAASK,GACpB,GAAIE,GAAQzB,KAAKmC,gBAAgBZ,EAEjC,KAAIE,EACF,MAAOzB,KAIT,IAAIoC,GAAYlC,EAAMa,KAAKP,UAAW,EAAGA,UAAU6B,OAAS,GAExDC,EAAkBtC,KAAKuC,eAAehC,MAAMP,MAAOuB,EAAOE,GAAOQ,OAAOG,GAI5E,OAFApC,MAAKwC,SAASF,GAAmBX,SAAS,IAEnC3B,MAGTmC,gBAAiB,SAASZ,GACxB,GAAID,GAAStB,KAAKc,cAAcS,EAEhC,OAAOzB,GAAE0B,QAAQF,GAAUA,EAAO,GAAKA,GAGzCiB,eAAgB,SAASE,EAAYhB,GACnC,GAAIW,GAAYtC,EAAE4C,KAAKlC,UAAW,GAE9B8B,EAAkBb,CAMtB,OAJA3B,GAAEuB,KAAKe,EAAW,SAASO,GACzBL,EAAkBA,EAAgBM,QAAQ3C,EAAY0C,KAGjDL,KAIPO,EAAuBhD,CAE3B,OAAOgD","file":"backbone.eventrouter.min.js","sourcesContent":["/**\n * backbone.eventrouter - A highly opinionated, simplistic Backbone.Router coupled with a Backbone.Radio.Channel\n * @version v0.1.0\n * @link https://github.com/RoundingWellOS/backbone.eventrouter\n * @license MIT\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory(require('underscore'), require('backbone'), require('backbone.radio')) :\n  typeof define === 'function' && define.amd ? define(['underscore', 'backbone', 'backbone.radio'], factory) :\n  global.Backbone.EventRouter = factory(global._, global.Backbone, global.Radio)\n}(this, function (_, Backbone, Radio) { 'use strict';\n\n  var namedParam = /(\\(\\?)?:\\w+/;\n  var slice = [].slice;\n\n  var EventRouter = Backbone.EventRouter = Backbone.Router.extend({\n    constructor: function(options) {\n      options = _.extend({}, options);\n\n      Backbone.Router.apply(this, arguments);\n\n      _.extend(this, _.pick(options, ['channelName', 'routeTriggers']));\n\n      this._ch = Backbone.Radio.channel(_.result(this, 'channelName'));\n\n      if(_.isFunction(this.routeTriggers)) {\n        this.routeTriggers = this.routeTriggers.call(this, options);\n      }\n\n      this._createRoutes();\n\n      this.listenTo(this._ch, 'all', this.handleRoute);\n    },\n\n    channelName: 'event-router',\n\n    getChannel: function() {\n      return this._ch;\n    },\n\n    _createRoutes: function() {\n      _.each(this.routeTriggers, function(routes, event) {\n        routes = _.isArray(routes) ? routes : [routes];\n        _.each(routes, function(route) {\n          this.route(route, event, _.bind(this._ch.trigger, this._ch, event));\n        }, this);\n      }, this);\n    },\n\n    route: function(route, name, callback) {\n      if (_.isFunction(name)) {\n        callback = name;\n        name = '';\n      }\n      if (!callback) {\n        callback = this[name];\n      }\n      if(!callback) {\n        return this;\n      }\n\n      var wrappedCallback = _.bind(function() {\n        var args = slice.call(arguments);\n        this.trigger('before:route', name, args);\n        this.trigger.apply(this, ['before:route:' + name].concat(args));\n        callback.apply(this, args);\n      }, this);\n\n      return Backbone.Router.prototype.route.call(this, route, name, wrappedCallback);\n    },\n\n    handleRoute: function(event) {\n      var route = this.getDefaultRoute(event);\n\n      if(!route) {\n        return this;\n      }\n\n      // remove the event name and the query string from the passed arguments\n      var eventArgs = slice.call(arguments, 1, arguments.length - 1);\n\n      var translatedRoute = this.translateRoute.apply(this, [event, route].concat(eventArgs));\n\n      this.navigate(translatedRoute, { trigger: false });\n\n      return this;\n    },\n\n    getDefaultRoute: function(event) {\n      var routes = this.routeTriggers[event];\n\n      return _.isArray(routes) ? routes[0] : routes;\n    },\n\n    translateRoute: function(routeEvent, route) {\n      var eventArgs = _.tail(arguments, 2);\n\n      var translatedRoute = route;\n\n      _.each(eventArgs, function(arg) {\n        translatedRoute = translatedRoute.replace(namedParam, arg);\n      });\n\n      return translatedRoute;\n    }\n  });\n\n  var backbone_eventrouter = EventRouter;\n\n  return backbone_eventrouter;\n\n}));\n"],"sourceRoot":"/source/"}